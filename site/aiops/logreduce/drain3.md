# Drain3

## 算法简介

Drain是2017年提出的在线日志解析方法，Drain3将Drain进行了改造使其能过够再Python3下使用并使用与实际的生产环境。Drain3的核心思想与Drain一致，都是基于“同一个日志模板产生的日志经过分词得到的词的个数是相同的”这一假设，在词假设前提下，建立一个由日志长度、前缀单词和日志模板组成的Parse Tree

## 使用场景

本算法适用于对日志进行 `实时解析和分析`，准确率和效率较高

## 算法原理

![Drain3](./img/drain3.png)

对于输入的日志首先会使用正则表达式对常用变量进行替换，然后再进行分词，根据分词的长度将日志分到不同的子节点中，然后再根据第一个分词分到不同的groups中。分到对应的日志groups桶中后，将会计算日志与每个group的模式之间的相似度，并取最大值与阈值进行比较，如果相似度大于阈值则将日志归入相应group并将模式中与日志不同的部分用*替代，返回该模式；如果相似度小于阈值则创建一个新的group，group的模式为日志本身并将其返回。以下是Drain3对日志进行模式发现的example

![Drain3](./img/drain3_example.png)


## 论文链接

https://jiemingzhu.github.io/pub/pjhe_icws2017.pdf