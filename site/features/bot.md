# 机器人管理

机器人管理模块主要用于对Pilot进行管理，在这里可以对Pilot进行上线、下线，回复规则与对话记录管理等操作

## 1.机器人

为了适用不同的场景，比如服务台知识库问答，运维专门问答等场景，可以设置不同的机器人，一个机器人对应一个Pilot，Pilot被K8S所调度，每个Pilot本质上是一个Pod。

### 1.1机器人列表

机器人列表展示了所有创建的机器人，支持对机器人进行上线/下线。上线的机器人可以正常运行，通过配置前端对话框响应与其交互的请求；下线的机器人则停止工作，不再响应请求。

![机器人列表.png](https://static.cwoa.net/f1037ad159e5495f89ea470fe345f8ab.png)

### 1.2 机器人配置

对每个机器人进行基础模型和LLM技能的配置，让该机器人具备对应能力，此外还可以配置消息通道，以便更好触达用户。

![机器人.png](https://static.cwoa.net/15e9cda0c5b046cf9f63403e40917bb3.png)

**基本信息**

针对每一台机器人，你都可以设置其名称、ID、描述等基本信息。基本信息有助于理解机器人的作用和状态，并且可以作为识别和搜索的条件。

![机器人基本信息.png](https://static.cwoa.net/2b56e9b613fa4aea856b34cae270c360.png)

**模型设置**

为该机器人选择一个基础模型进行服务，基础模型是机器人在进行意图识别、语言处理等任务时所依赖的基本AI模型。目前已经内置了核心模型，其他模型语料撰写和模型训练可以在“拓展包-模型”中进行。

**LLM模型**

为该机器人选择对应的LLM技能，比如开放知识问答、自动化执行等等，LLM是在基础模型上增加的技能包，可以提供更精细、更高级的语言理解和任务执行。对于LLM模型，目前已经内置了基于ChatGPT的开放问答技能，其他更多技能可在“AI模型-LLM模型”中拓展。

![机器人技能.png](https://static.cwoa.net/e34ad2069a1e49838a4866f950983ca4.png)

**通道**

为了满足使用者多渠道的使用需求，机器人支持设置与用户进行交互的通道，比如Web、企微、钉钉等，通道配置，可以使机器人更好地为用户提供服务。

**高级设置**

支持为该机器人设置域名/SSL/域名等设置，便于设置用户/管理员如何访问该机器人

![机器人设置.png](https://static.cwoa.net/7e92e9f59a54466082fc582f7e2c716d.png)

## 2.对话记录

对话记录里面记录了每个机器人与用户的对话记录，可以用于对话记录的审计、标注、以及人工介入等场景

![机器人对话.png](https://static.cwoa.net/8f262863d588432ab18534a3ac86d8ed.png)

## 3.对话规则

有时候希望同一个机器人在同一个问题的时候， 可以针对不同的用户使用不同的大模型技能，这个时候就可以在对话规则中进行配置。每个规则可以配置生效的机器人、使用的技能、技能提示词以及生效的用户和用户组。

![机器人规则.png](https://static.cwoa.net/a8fffbd2826644d584597114a6803952.png)

## API

### 执行机器人对话

> POST /api/bot/skill_execute/

```
{
  "bot_id": 1,
  "skill_id": "action_llm_fallback",
  "user_message": "你是谁",
  "sender_id":"",
  "converation_history": [
  ]
}
```

### 主动消息推送

> POST /conversations/{sender_id}/trigger_intent

```
{
  "name": "EXTERNAL_UTTER",
  "entities": {
    "content": "你好呀"
    "channel": "rest"
  }
}
```
